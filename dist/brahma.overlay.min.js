Brahma.app("overlay",{width:"auto",context:null,config:{content:"",panel:{style:{},"class":!1},overlay:{style:{},"class":!1},effect:{type:"fade",direction:0,duration:750,easing:"cubic-bezier(0.215, 0.61, 0.355, 1)"},"class":!1,freezeDocument:!0,verticalMargin:!1,autoshow:!1,zIndex:!1,outsideClose:!0,escapeClose:!1,autobinds:!0,modernFreezee:!0},current:{backup:{},freezed:!1},wrappers:{content:null},z:{overlay:0,panel:0},run:function(){var component=this;return this.context=this.getContext(),this.newOverlay(this.context),this.appendContent(),this.config.autoshow&&this.show(),this.config.outsideClose&&(Brahma(this.wrappers.contentWrapper).bind("click",function(e){e.stopPropagation()}),Brahma(this.wrappers.overlay).bind("click",function(){component.hide()})),this.bind("document.keydown",function(e){27==e.which&&this.hide()}),Brahma.document.translateEvents(this,"document.keydown"),this.bindContents(),this},bindContents:function(){var component=this;this.config.autobinds&&(Brahma(this.wrappers.content).find("[overlay-trigger=close]").bind("click",function(){return Brahma(this).removeAttr("overlay-trigger"),component.close(),!1}),Brahma(this.wrappers.content).find("[overlay-trigger=hide]").bind("click",function(){return Brahma(this).removeAttr("overlay-trigger"),component.hide(),!1}))},getContext:function(){try{var tagName=Brahma(this.selector)[0].tagName.strToLower()}catch(e){var tagName=!1}switch(tagName){case"body":return Brahma(Brahma(this.selector)[0]);default:return Brahma(Brahma(this.selector)[0]==document?"body":"body")}},freeze:function(callback){var that=this,callback=callback;if("function"==typeof callback&&setTimeout(callback,100),this.current.freezed)return this;var body=Brahma("body");if(this.current.backup={scrollTop:Brahma(this.context)[0].scrollTop,overflow:body.css("overflow"),margin:Brahma("body").css("margin"),marginDifference:0},this.current.freezed=!0,this.config.modernFreezee){var rwidth=Brahma("body")[0].clientWidth;body.css({overflow:"hidden"});var that=this;Brahma.frame(function(){var nwidth=Brahma("body")[0].clientWidth;that.current.backup.marginDifference=parseInt(Brahma("body").css("margin-right")||0)+nwidth-rwidth,Brahma("body").css("margin-right",that.current.backup.marginDifference+"px")})}else{var not=[];if(not=not.join(","),Brahma(this.context).is("body"))var fakeScrollBar=Brahma(this.context)[0].scrollHeight>Brahma(window)[0].innerHeight;else var fakeScrollBar=!1;Brahma(this.context).find(">*").not(not).wrapAll("div").tie(function(){that.wrappers.freezedContainer=this}).condition(fakeScrollBar,function(){Brahma("body").css({"overflow-y":"scroll"})});var contextTagName=Brahma(this.context)[0].tagName.toUpperCase();"BODY"!=contextTagName&&Brahma(this.context).css("position","relative"),Brahma(this.wrappers.freezedContainer).css({position:"BODY"==Brahma(this.context)[0].tagName.toUpperCase()?"fixed":"absolute",top:0,left:0,width:"BODY"==contextTagName?"100%":Brahma(this.context).width(),height:"BODY"==contextTagName?"100%":Brahma(this.context).height(),overflow:"hidden"}),Brahma(this.wrappers.freezedContainer).find(">*").not(not).wrapAll("div"),Brahma(this.wrappers.freezedContainer).find(">div").css({width:"100%","margin-top":-1*this.current.backup.scrollTop+"px"})}},unfreeze:function(){this.current.freezed=!1;var contextTagName=Brahma(this.context)[0].tagName.toUpperCase(),that=this;if(this.config.modernFreezee){"BODY"==contextTagName&&Brahma(this.context).css({overflow:this.current.backup.overflow,margin:""});var shift=that.current.backup.marginDifference/2;Brahma(that.wrappers.table).css({"-webkit-transform":"translateX("+shift+"px)","-ms-transform":"translateX("+shift+"px)",transform:"translateX("+shift+"px)"}),setTimeout(function(){Brahma(that.wrappers.table).css({"-webkit-transform":"translateX(0px)","-ms-transform":"translateX(0px)",transform:"translateX(0px)"})},this.config.effect.duration),console.log("this.config.duration",this.config.effect.duration)}else"BODY"==contextTagName&&Brahma(this.context).css({overflow:"auto"}),Brahma(this.context).put(Brahma(this.wrappers.freezedContainer).find(">div").find(">*")),"BODY"==contextTagName&&(Brahma(this.context)[0].scrollTop=this.current.backup.scrollTop),Brahma(this.wrappers.freezedContainer).remove()},newOverlay:function(context){var plugin=this;this.wrappers.overlay=Brahma(context).put("div",{"class":"mb-plugin-overlay"}).css(Brahma.extend({width:"100%",height:"100%",position:"fixed",top:"0px",left:"0px",backgroundColor:"none",backgroundImage:"none",display:"none","overflow-y":"auto","overflow-x":"hidden"},this.config.overlay.style)).tie(function(){plugin.config.overlay["class"]&&Brahma(this).addClass(plugin.config.overlay["class"])}),this.z.overlay=this.config.zIndex?this.config.zIndex:Brahma.document.zindex.get(2),Brahma(this.wrappers.overlay).css("z-index",this.z.overlay),Brahma(this.wrappers.overlay).put("table",{cellspacing:0,cellpadding:0}).tie(function(){plugin.wrappers.table=this}).css({height:"100%",margin:"0 auto"}).put("tbody").put("tr").put("td").css({height:"1%"}).and("td").css({height:"100%","vertical-align":"top","text-align":"center"}).tie(function(){plugin.z.panel=plugin.config.zIndex?plugin.config.zIndex+1:Brahma.document.zindex.get(1),plugin.wrappers.contentWrapper=Brahma(this).put("div").css(Brahma.extend({display:"inline-block","text-align":"left",width:plugin.config.width+"px"},plugin.config.panel.style)).tie(function(){plugin.config.panel["class"]&&Brahma(this).addClass(plugin.config.panel["class"])}).hide().condition(plugin.config["class"],function(c){return Brahma(this).addClass(c),this},function(){return this}).css("z-index",plugin.z.panel),Brahma(this).css(plugin.config.verticalMargin?{padding:parseInt(plugin.config.verticalMargin)+"px 0"}:{"vertical-align":"middle"}),plugin.wrappers.content=Brahma(plugin.wrappers.contentWrapper).put("div")}).and("td").css({height:"1%"})},appendContent:function(){var plugin=this;switch(typeof this.config.content){case"string":this.wrappers.content.html(this.config.content),plugin.trigger("ready",[this.wrappers.content]);break;case"function":this.config.content.call(this,this.wrappers.content)}return"string"==typeof this.config.url&&Brahma(this.wrappers.content).load(this.config.url,function(){plugin.trigger("ready",[plugin.wrappers.content])}),this},html:function(){if(arguments.length>0){switch(typeof arguments[0]){case"function":arguments[0].call(this,this.wrappers.content);break;case"object":Brahma(this.wrappers.content).empty().put(arguments[0]);break;default:Brahma(this.wrappers.content).html(arguments[0])}return this.bindContents(),this}return this.wrappers.content},show:function(){window.test=this,setTimeout(function(){console.log(window.test.eventListners)},2e3);var component=this;switch(this.config.freezeDocument&&this.freeze(),this.module("effect").fadeIn(Brahma(this.wrappers.overlay)[0],1e3),this.config.effect.type){case"slide":this.module("effect").slideIn({duration:this.config.effect.duration,direction:this.config.effect.direction},function(){component.trigger("show")});break;case"hang":this.module("effect").hangIn({duration:this.config.effect.duration,direction:this.config.effect.direction},function(){component.trigger("show")});break;default:Brahma(this.wrappers.contentWrapper).show(),component.trigger("show")}return this},hide:function(callback){this.trigger("beforeHide"),this.config.freezeDocument&&this.unfreeze();var callback=callback,component=this;switch(this.config.effect.type){case"slide":this.module("effect").slideOut({duration:this.config.effect.duration,direction:this.config.effect.direction},function(){Brahma(component.wrappers.contentWrapper).hide(),this.module("effect").fadeOut(Brahma(component.wrappers.overlay)[0],this.config.duration,function(){component.trigger("hide"),"function"==typeof callback&&callback.apply(component)})});break;case"hang":this.module("effect").hangOut({duration:this.config.effect.duration,direction:this.config.effect.direction},function(){Brahma(component.wrappers.contentWrapper).hide(),this.module("effect").fadeOut(Brahma(component.wrappers.overlay)[0],this.config.duration,function(){component.trigger("hide"),"function"==typeof callback&&callback.apply(component)})});break;default:this.module("effect").fadeOut(Brahma(component.wrappers.overlay)[0],this.config.duration,function(){component.trigger("hide"),"function"==typeof callback&&callback.apply(component)})}},close:function(){return this.hide(function(){this.remove()}),this},remove:function(){this.trigger("beforeDestroy"),Brahma(this.wrappers.content).remove(),Brahma(this.wrappers.overlay).remove(),this.config.zIndex||(Brahma.document.zindex.free(this.z.overlay),Brahma.document.zindex.free(this.z.panel)),this.destroy()},destroy:function(){Brahma.each(this,function(){delete this})}}),Brahma.app("overlay").module("effect",{_slide:function(options,callback){var screenHeight=Brahma(this.master.context).height();0==screenHeight&&(screenHeight=Brahma(window).height());var screenWidth=Brahma(this.master.context).width();0==screenWidth&&(screenWidth=Brahma(window).width());var position={top:(screenHeight-Brahma(this.master.wrappers.contentWrapper).height())/2,left:(screenWidth-Brahma(this.master.wrappers.contentWrapper).width())/2},cover={top:position.top+Brahma(this.master.wrappers.contentWrapper).height(),right:screenWidth-position.left,bottom:position.top+Brahma(this.master.wrappers.contentWrapper).height(),left:position.left+Brahma(this.master.wrappers.contentWrapper).width()};switch(options.direction){case"top":options.direction=0;break;case"right":options.direction=90;break;case"bottom":options.direction=180;break;case"left":options.direction=270}if(options.direction>=0&&options.direction<90)var calc=Brahma.trigonometria.delta2c1s(cover.right>cover.top?cover.right:cover.top,options.direction,90);if(options.direction>=90&&options.direction<180)var calc=Brahma.trigonometria.delta2c1s(cover.right>cover.bottom?cover.right:cover.bottom,options.direction,90);if(options.direction>=180&&options.direction<270)var calc=Brahma.trigonometria.delta2c1s(cover.left>cover.bottom?cover.left:cover.bottom,options.direction,90);if(options.direction>=270&&options.direction<=359)var calc=Brahma.trigonometria.delta2c1s(cover.left>cover.top?cover.left:cover.top,options.direction,90);if(calc.b=Math.round(calc.b),options.reverse)var startX=0,startY=0,endX=calc.c,endY=-1*calc.b;else var startX=calc.c,startY=-1*calc.b,endX=0,endY=0;var options=((Brahma(this.master.context).width()-Brahma(this.master.wrappers.contentWrapper).outerWidth())/2+Brahma(this.master.wrappers.contentWrapper).outerWidth(),Brahma.extend({direction:options.direction||0,duration:options.duration||450},options||{}));this._translate(this.master.wrappers.contentWrapper,startX,startY,0),Brahma(this.master.wrappers.contentWrapper).show();var that=this;setTimeout(function(){if(that._translate(that.master.wrappers.contentWrapper,endX,endY,that.master.config.effect.duration),"function"==typeof callback?callback:!1){var component=that.master;setTimeout(function(){callback.call(component)},that.master.config.effect.duration)}},5)},slideIn:function(options,callback){options.reverse=!1,this._slide(options,callback)},slideOut:function(options,callback){var callback=callback,component=this.master;options.reverse=!0,this._slide(options,function(){Brahma(component.wrappers.contentWrapper).hide(),callback()})},hangIn:function(options,callback){var callback=callback,component=this.master;this._transform(this.master.wrappers.contentWrapper,"translate(0, -30px) scale(0.95)",0),Brahma(this.master.wrappers.contentWrapper).css("opacity",0).show();var that=this;setTimeout(function(){that.fadeIn(Brahma(that.master.wrappers.contentWrapper),options.duration||that.master.config.effect.duration),that._transform(that.master.wrappers.contentWrapper,"translate(0, 0) scale(1)",options.duration||that.master.config.effect.duration),"function"==typeof callback&&setTimeout(function(){callback.call(component)},options.duration||that.master.config.effect.duration)},5)},hangOut:function(options,callback){var callback=callback,component=this.master,that=this;this._transform(this.master.wrappers.contentWrapper,"translate(0, -15px) scale(0.95)",options.duration||that.master.config.effect.duration),this.fadeOut(Brahma(this.master.wrappers.contentWrapper),options.duration||this.master.config.effect.duration),console.log(options.duration||that.master.config.effect.duration),"function"==typeof callback&&setTimeout(function(){callback.call(component)},options.duration||that.master.config.effect.duration)},_translate:function(el,x,y,duration){for(var dur={},opt={},cap=["-webkit-","-o-","-ms-","-moz-"],i=0;i<cap.length;i++)dur[cap[i]+"transition"]=cap[i]+"transform "+duration+"ms "+this.master.config.effect.easing,opt[cap[i]+"transform"]="translate("+Brahma.utility.getWebUnits(x)+","+Brahma.utility.getWebUnits(y)+")";Brahma(el).css(dur).css(opt)},_transform:function(el,props,duration){for(var dur={},opt={},cap=["-webkit-","-o-","-ms-","-moz-"],i=0;i<cap.length;i++)dur[cap[i]+"transition"]=cap[i]+"transform "+duration+"ms "+this.master.config.effect.easing,opt[cap[i]+"transform"]=props,opt[cap[i]+"transform-origin"]="50% 50%";Brahma(el).css(dur).css(opt)},fadeIn:function(el,duration,callback){var el=Brahma(el)[0];Brahma(el).css("opacity",0),"none"===Brahma(el).css("display")&&(Brahma(el).show(),console.log("SHOW"));var o=0,interval=setInterval(function(){o+=.01,el.style.opacity=o,o>=1&&(el.style.opacity=1,clearInterval(interval),"function"==typeof callback&&callback())},duration/1e3);return el},fadeOut:function(el,duration,callback){var el=Brahma(el)[0];Brahma(el).css("opacity",1),"none"===Brahma(el).css("display")&&Brahma(el).show();var o=1,interval=setInterval(function(){o-=.01,el.style.opacity=o,0>=o&&(el.style.opacity=0,clearInterval(interval),Brahma(el).hide(),"function"==typeof callback&&callback())},duration/1e3);return el}});
//# sourceMappingURL=brahma.overlay.min.js.map